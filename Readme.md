# Weather Forecasting Project

## Описание

Проект реализует прогнозирование средней температуры по городам России на краткосрочный (7 дней) и долгосрочный горизонты с использованием моделей XGBoost и LSTM. Основная цель — создать точные модели прогноза, а также обеспечить визуальный мониторинг и анализ данных в Grafana.

---

## Основные этапы

* **Сбор и подготовка данных**
  Используются исторические погодные данные из PostgreSQL (около 13 млн записей), включая температурные показатели, осадки, снег и солнечную активность.

* **Обучение моделей**

  * **XGBoost** для долгосрочного прогноза средней температуры.
  * **LSTM с эмбеддингами городов** для высокоточного краткосрочного прогноза.

* **Анализ и визуализация**

  * Оценка моделей по метрикам MAE, RMSE, R².
  * Визуализация трендов и сравнение прогнозов с реальными данными.
  * Мониторинг и построение графиков по ключевым климатическим гипотезам (температурный диапазон, доля снега, солнечная активность и др.) в Grafana на основе агрегированных данных.

---

## Технологии

* Python (Pandas, NumPy)
* PyTorch (LSTM)
* XGBoost
* SQLAlchemy, PostgreSQL
* Grafana для визуализации временных рядов и мониторинга
* Logging для отслеживания процессов обучения и выполнения

---

## Особенности

* Работа с большими объёмами данных (более 13 млн строк).
* Быстрая и эффективная загрузка и агрегация данных в PostgreSQL для последующего анализа.
* Использование эмбеддингов для учёта уникальных особенностей городов в модели LSTM.
* Параллелизация обучения LSTM на GPU для ускорения.
* Интеграция с Grafana для построения интерактивных графиков, включая:

  * Тренды суточного температурного диапазона по городам.
  * Изменение доли снега в общих осадках в России и Германии.
  * Сезонные сдвиги температурных пиков.
  * Снижение солнечной активности (tsun) в крупных городах.

---

Вот обновлённый раздел **Запуск** с учётом твоих уточнений:

---

## Запуск

1. Установить зависимости:

   ```bash
   pip install -r requirements.txt
   ```

2. Настроить подключение к базе данных PostgreSQL с погодными данными.

3. Поднять Grafana в Docker (пример):

   ```bash
   docker run -d -p 3000:3000 --name=grafana grafana/grafana
   ```

4. Запустить обучение модели (краткосрочный прогноз):

   ```bash
   python lstm_low_horisont.py
   ```

5. Запустить веб-приложение для визуализации и мониторинга результатов:

   ```bash
   streamlit run streamlit_app_low_horizont.py
   ```

6. В Grafana использовать готовые SQL-запросы для построения графиков и мониторинга показателей.
